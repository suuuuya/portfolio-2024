<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Shapes</title>
    <style>
        html,body{margin: 0;padding: 0;width: 100%;height: 100%;overflow: hidden;}
        canvas{position: relative; display: block;width:100%;height: 100%; background:linear-gradient(347deg, #c1c1c1, #fff);/*background-image: url('img/bg.jpg');*/background-repeat: no-repeat;background-position: center;  background-size: cover !important;}
        body::after{
            content: "";
            position: absolute;
            top: -21vw;
            left: -21vw;
            width: calc(100% + 42vw);
            height: calc(100% + 42vw);
            background-position: 50%;
            background-image: url(img/noise.gif);
            /*animation: noise 1s steps(4) infinite;*/
            pointer-events: none;
            opacity: 0.05;
        }
        @keyframes noise {
			0% { transform: translate3d(0, 0, 0); }
			10% { transform: translate3d(-7vw, -7vw, 0); }
			20% { transform: translate3d(-14vw, 7vw, 0); }
			30% { transform: translate3d(7vw, -14vw, 0); }
			40% { transform: translate3d(-7vw, -21vw, 0); }
			50% { transform: translate3d(-14vw, 7vw, 0); }
			60% { transform: translate3d(21vw, 21vw, 0); }
			70% { transform: translate3d(14vw, 14vw, 0); }
			80% { transform: translate3d(-21vw, -21vw, 0); }
			90% { transform: translate3d(14vw, 7vw, 0); }
			to { transform: translate3d(7vw, 7vw, 0); }
		}
        .custom-shape {
            position: absolute;
            top: 10%;
            left: 60%;
            width: 10%;
            height: 6%;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        #canvas-container{position: relative; width: 100%;height: 100%;}
    </style>
</head>
<body>
    <div id="canvas-container"></div>
<script src="./js/lib/matter.min.js"></script>
<script src="./js/lib/matter-wrap.min.js"></script>
<script>
var Example = Example || {};

Example.mixed = function () {
    var Engine = Matter.Engine,
        Render = Matter.Render,
        Runner = Matter.Runner,
        Bodies = Matter.Bodies,
        Composite = Matter.Composite,
        Mouse = Matter.Mouse,
        MouseConstraint = Matter.MouseConstraint,
        Common = Matter.Common;

    var engine = Engine.create(),
        world = engine.world;

    var render = Render.create({
        element: document.getElementById('canvas-container'),
        engine: engine,
        options: {
            width: window.innerWidth,
            height: window.innerHeight,
            wireframes: false,
            background: false,
        }
    });

    Render.run(render);

    var runner = Runner.create();
    Runner.run(runner, engine);

    var shapes = []; // 도형 저장 배열

    // 도형 추가 및 크기 조정 로직을 포함한 함수
    var addShape = function (texture, options) {
        var scale = Math.min(window.innerWidth, window.innerHeight) / 1000; // 기본 비율 계산
        options = {...options, ...{
            restitution: 0.7,
            render: {
                sprite: {
                    texture: texture,
                    xScale: scale * options.scale,
                    yScale: scale * options.scale
                }
            }
        }};

        var body = options.shape === 'circle' ?
            Bodies.circle(Math.random() * window.innerWidth, Math.random() * window.innerHeight, options.radius * scale, options) :
            Bodies.rectangle(Math.random() * window.innerWidth, Math.random() * window.innerHeight, options.width * scale, options.height * scale, options);

        body.initialScale = scale; // 초기 스케일 저장
        shapes.push(body);
        return body;
    };

    // 도형 추가
    // 이 부분에서 도형을 추가하며, 각 도형의 특성에 따라 조정합니다.
    Composite.add(world, [
        addShape('./img/icon3.png', { shape: 'rectangle', width: 1446, height: 112, scale: 0.7 }),
        addShape('./img/icon2.png', { shape: 'circle', radius: 146, scale: 0.7 }),
        addShape('./img/icon1.png', { shape: 'rectangle', width: 322, height: 249, scale: 0.8 }),
        addShape('./img/tag.png', { shape: 'rectangle', width: 375, height: 136, scale: 0.6 })
    ]);

    // 벽 추가
    Composite.add(world, [
        Bodies.rectangle(window.innerWidth / 2, -26, window.innerWidth, 50, { isStatic: true }),
        Bodies.rectangle(window.innerWidth / 2, window.innerHeight + 26, window.innerWidth, 50, { isStatic: true }),
        Bodies.rectangle(-26, window.innerHeight / 2, 50, window.innerHeight, { isStatic: true }),
        Bodies.rectangle(window.innerWidth + 26, window.innerHeight / 2, 50, window.innerHeight, { isStatic: true })
    ]);

    // 창 크기에 따른 도형 크기 비율 조정
    var resizeShapes = function () {
        var scale = Math.min(window.innerWidth, window.innerHeight) / 1000; // 비율 계산
        shapes.forEach(function(shape) {
            Matter.Body.scale(shape, scale / shape.initialScale, scale / shape.initialScale); // 현재 스케일 대비 조정
            shape.initialScale = scale; // 새로운 스케일 저장
        });
    };

    window.addEventListener('resize', function() {
        resizeShapes();
        Render.lookAt(render, {
            min: { x: 0, y: 0 },
            max: { x: window.innerWidth, y: window.innerHeight }
        });
    });

    var mouse = Mouse.create(render.canvas),
        mouseConstraint = MouseConstraint.create(engine, {
            mouse: mouse,
            constraint: {
                stiffness: 1,
                render: { visible: false }
            }
        });

    Composite.add(world, mouseConstraint);
    render.mouse = mouse;

    return {
        engine: engine,
        runner: runner,
        render: render,
        canvas: render.canvas,
        stop: function () {
            Matter.Render.stop(render);
            Matter.Runner.stop(runner);
        }
    };
};

Example.mixed();
</script>
</body>
</html>
